<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Setup</title>
  </head>
  <body>
    <div align=center>
       <h3>Enter Your Masari Address</h3>
      <input type="text" id="address">
    </div>

    <div align=center>
      <h3>Select A Pool</h3>
      <button type="button" onClick="masaricoin()">masaricoin.com</button>
      <button type="button" onClick="optimusblue()">msr.optimusblue.com</button>
    </div>
     <div align=center style="padding-top: 15px">
       <button type="button" onClick="finish()">Finish</button>
     </div>
    <script>
      require('./renderer.js')
      var fs = require('fs')
      const electron = require('electron')
      const childProcess = require('child_process');

      let pool;

      function masaricoin() {
        pool = "pool.masaricoin.com:3333";
      }

      function optimusblue() {
        pool = "msr.optimusblue.com:3333"
      }

      function writePoolsTxt() {
        var address = document.getElementById('address').value
        var configText = "\"pool_list\" :[ {\"pool_address\" : \"" + pool + "\", \"wallet_address\" : \"" + address + "\", \"rig_id\" : \"oneclick\", \"pool_password\" : \"x\", \"use_nicehash\" : false, \"use_tls\" : false, \"tls_fingerprint\" : \"\", \"pool_weight\" : 1 }, ], \"currency\" : \"masari\","
        fs.writeFile("pools.txt", configText, function(e) {
          if(e) {
            return console.log(e);
          }
        });
      }

      function writeConfigTxt() {
        var configText = "\"call_timeout\" : 10, \"retry_time\" : 30, \"giveup_limit\" : 0, \"verbose_level\" : 3, \"print_motd\" : true, \"h_print_time\" : 60, \"aes_override\" : null, \"use_slow_memory\" : \"warn\", \"tls_secure_algo\" : true, \"daemon_mode\" : false, \"flush_stdout\" : false, \"output_file\" : \"\", \"httpd_port\" : 0, \"http_login\" : \"\", \"http_pass\" : \"\", \"prefer_ipv4\" : true,"
        fs.writeFile("config.txt", configText);
      }

      function writeCpuTxt() {
        var configText = "\"cpu_threads_conf\" : [ { \"low_power_mode\" : false, \"no_prefetch\" : true, \"affine_to_cpu\" : 0 }, ],"
        fs.writeFile("cpu.txt", configText);
      }

      function finish() {
        writeConfigTxt();
        writePoolsTxt();
        writeCpuTxt();
        var thisWindow = electron.remote.getCurrentWindow();
        setTimeout( function () { thisWindow.close() } , 500);
      }
    </script>
  </body>
</html>
